# Swoole协程详解

​    从`2.0`版本开始`Swoole`提供了**协程(Coroutine)**特性，可使用协程+通道的全新编程模式，代替异步回调。应用层可使用完全同步的编程方式，底层自动实现异步`IO`。

​    协程可以理解为纯用户态的线程，其通过协作而不是抢占来进行切换。相对于进程或者线程，协程所有的操作都可以在用户态完成，创建和切换的消耗更低。`Swoole`可以为每一个请求创建对应的协程，根据`IO`的状态来合理的调度协程，这会带来了以下优势：

​    开发者可以无感知的用同步的代码编写方式达到异步IO的效果和性能，避免了传统异步回调所带来的离散的代码逻辑和陷入多层回调中导致代码无法维护

​    同时由于底层封装了协程，所以对比传统的`PHP`层协程框架，开发者不需要使用`yield`关键词来标识一个协程`IO`操作，所以不再需要对`yield`的语义进行深入理解以及对每一级的调用都修改为`yield`，这极大的提高了开发效率

​    要理解是什么是“用户态的线程”，必然就要先理解什么是“内核态的线程”。内核态的线程是由操作系统来进行调度的，在切换线程上下文时，要先保存上一个线程的上下文，然后执行下一个线程，当条件满足时，切换回上一个线程，并恢复上下文。协程也是如此，只不过，用户态的线程不是由操作系统来调度的，而是由程序员来调度的，是在用户态的。

